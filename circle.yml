machine:
  services:
    - docker

dependencies:
  cached_directories:
    - "/var/lib/docker"
  override:
    - docker info
    - docker build -t lewisl9029/toc-dev:latest .
    - docker run -v $(pwd):/toc lewisl9029/toc-dev:latest npm install
    - docker run -v $(pwd):/toc lewisl9029/toc-dev:latest jspm install

test:
  override:
    - echo "no tests =/"

deployment:
  staging:
    branch: master
    owner: lewisl9029
    commands:
      - ./toc-deploy-staging.sh
  production:
    tag: /v[0-9]+(\.[0-9]+)*/
    owner: lewisl9029
    commands:
      - ./toc-deploy-production.sh
